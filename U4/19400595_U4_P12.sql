--PRACTICA 12
--AUTOR: INZUNSA DIAZ CESAR ALEJANDRO
--NO. CONTROL: 19400595
--FECHA: 07/05/22
--DESCRIPCION: Practicar la creacion y restauracion de backups

--PONER EN USO LA BD
USE pubs;

--A) UPSS DAÑASTE TU BD PUBS YA QUE ELIMINASTE UNA TABLA Y NO ERA
--NECESARIO. RESTAURA EL RESPALDO O LOS RESPALDOS NECESARIOS PARA
--PODER RECUPERAR TU BD ANTES DE HABERLA DAÑADO.
RESTORE DATABASE pubs
FROM DISK = 'C:\ABD2022\U4\Pubs_Completo1.BAK'
WITH REPLACE, NORECOVERY;

RESTORE DATABASE pubs
FROM DISK = 'C:\ABD2022\U4\Pubs_Diferencial2.BAK'
WITH REPLACE, RECOVERY;

--B) CREA UN RESPALDO COMPLETO NUEVAMENTE.
BACKUP DATABASE pubs
TO DISK = 'C:\ABD2022\U4\Pubs_Completo2.BAK'
WITH
NAME = 'Pubs_Completo2',
DESCRIPTION = 'Segundo respaldo completo';

--C) DE LOS MOVIMIENTOS QUE HABIAS REALIZADO EN LA BD, QUE NO PUDISTE RECUPERAR?
--Se recuperaron todos los movimientos.

--D) VUELVE REALIZAR LO QUE NO PUDISTE RECUPERAR Y REALIZA UN RESPALDO DIFERENCIAL
BACKUP DATABASE pubs
TO DISK = 'C:\ABD2022\U4\Pubs_Diferencial3.BAK'
WITH DIFFERENTIAL,
NAME = 'Pubs_Diferencial3',
DESCRIPTION = 'Tercer respaldo diferencial';

--E) ELIGE TRES AUTORES E INSERTALE 2 PUBLICACIONES A CADA UNO
INSERT INTO titleauthor VALUES
('238-95-7766','TC7777',2,30),
('238-95-7766','BU2075',2,30),
('213-46-8915','BU1111',3,50),
('213-46-8915','PS3333',3,50),
('486-29-1786','BU7832',1,100),
('486-29-1786','PC8888',1,100);

--F) REALIZA UN RESPALDO DIFERENCIAL
BACKUP DATABASE pubs
TO DISK = 'C:\ABD2022\U4\Pubs_Diferencial4.BAK'
WITH DIFFERENTIAL,
NAME = 'Pubs_Diferencial4',
DESCRIPTION = 'Se insertaron dos publicaciones de tres autores';

--G) INSERTA 5 AUTORES MEXICANOS
INSERT INTO authors VALUES
('888-88-8888', 'Laura', 'Baeza', '111 111-1111', '67 Seventh Av.', 'Salt Lake City', 'UT', '84152', 1),
('888-88-8889', 'Barrera', 'Ave', '111 111-1111', '5720 McAuley St.', 'Oakland', 'CA', '94609', 1),
('888-88-8890', 'Blum', 'Liliana', '111 111-1111', '1956 Arlington Pl.', 'Rockville', 'MD', '20853', 1),
('888-88-8891', 'Boone', 'Luis', '111 111-1111', '55 Hillsdale Bl.', 'Corvallis', 'OR', '97330', 1),
('888-88-8892', 'Esquinca', 'Bernardo', '111 111-1111', '3 Balding Pl.', 'Gary', 'IN', '46403', 1);

--H) REALIZA UN RESPALDO DIFERENCIAL
BACKUP DATABASE pubs
TO DISK = 'C:\ABD2022\U4\Pubs_Diferencial5.BAK'
WITH DIFFERENTIAL,
NAME = 'Pubs_Diferencial5',
DESCRIPTION = 'Se insertaron cinco autores mexicanos';

--I) BORRAR LA BD (DROP DATABASE)
DROP DATABASE pubs;

--J) RECUPERA LA BD CON TODAS LAS ACTUALIZACIONES REALIZADAS DE LOS REGISTROS.
RESTORE DATABASE pubs
FROM DISK = 'C:\ABD2022\U4\Pubs_Completo2.BAK'
WITH REPLACE, NORECOVERY;

RESTORE DATABASE pubs
FROM DISK = 'C:\ABD2022\U4\Pubs_Diferencial5.BAK'
WITH REPLACE, RECOVERY;